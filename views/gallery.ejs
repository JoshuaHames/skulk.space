

<%- include('partials/header'); -%>

<script>
    let errorsound = new Audio("/sounds/error.mp3")
    let lastSelected = null;
    let lastPath = null;

    function Playerror(){
        errorsound.play();
    }

    function clearLast(){
        if (lastSelected != null){
            CollapseItem(lastSelected, lastPath);
        }
    }

    function ExpandItem(element, imgName){
        clearLast()
        lastSelected = element;
        lastPath = imgName
        elementDesc = document.getElementById(element.id + "-desc")
        elementImg = document.getElementById(element.id + "-img")

        elementImg.src = '/gallery/' + imgName + '.png'

        elementDesc.classList.remove("desc-expanded")

        elementImg.classList.add(element.id + '-imgExpanded')
        element.classList.add(element.id +'-expanded')

        elementDesc.classList.add("desc-expanded")
        
    }

    function CollapseItem(element, imgName){
        elementDesc = document.getElementById(element.id + "-desc")
        elementImg = document.getElementById(element.id + "-img")
        elementImg.src = '/gallery/thumb/' + imgName + '_S.png'
        element.classList.remove(element.id +'-expanded')
        elementImg.classList.remove(element.id + '-imgExpanded')
        elementDesc.classList.remove("desc-expanded")

    }

    function ToggleExpand(element, imgName){
        if (element.classList.contains(element.id +'-expanded')){
            CollapseItem(element, imgName);
        } else {
            ExpandItem(element, imgName);
        }
    }

</script>

<style>
    a {
        all: unset;
        box-shadow: #3f333198 10px 10px;
    }



    @media only screen and (max-device-width: 1400px) {
    /* Mobile Styles */

    #Gallery-Container{
        align-self: center;
        padding: 30px;;
        width: 90%;
        display: flex;
        flex-wrap: wrap;
        position: relative;
        justify-content: center;
    }

    .img-desc{
        opacity: 0;
        animation: fadeout 0.15s forwards;
        font-size: 20px;
        margin: 5px;
        padding: 10px;
        padding-top: 5px;
        padding-bottom: 5px;
        border-left: #f9cecbe7 solid 2px;
        border-top: #f9cecbe7 solid 2px;
        border-right: #fffdb4de solid 2px;
        border-bottom: #fffdb4cb solid 2px;
        border-radius: 5px;
        background-color: #f1979094;
    }

    .desc-expanded{
        animation: fadein 0.6s forwards;
    }


    #page-body{
        display: grid;
        grid-column: 1;
        justify-content: center;
    }

    #title{
        align-self: center;
    }

    #FooterIcon{
        width: 10%;
    }

    @keyframes expand {
        0%{height: 276px; transform: scale(1);}
        100%{height: 356px; transform: scale(1.6);}
    }
    @keyframes collapse {
        0%{height: 356px; transform: scale(1.6);}
        100%{height: 276px; transform: scale(1);}
    }
    @keyframes fadein {
        0%{opacity: 0;}
        100%{opacity: 1;}
    }
    @keyframes fadeout {
        0%{opacity: 1;}
        100%{opacity: 0;}
    }
    @keyframes zoomImg{
        0%{width: 256px; height:256px;}
        100%{width: 1000px; height:1000px;}
    }
    #GalleryIntro{
        width: 75%;
        color: white;
        padding: 8px;
        background-color: #rgba(126, 95, 126, 0.705);;
        border-style: solid;
        border-radius: 8px;
        height: 25px;
        z-index: 50;
        opacity: 0;
        animation: HeaderExpand-Mobile .5s 1s forwards linear, RGBShadow-Large 6s linear alternate-reverse infinite;
    }

    h4{
        margin-top: 0px;
    }

    #GalIntroContent{
        opacity: 0;
        font-size: x-large;
        animation: fadein .5s 1.5s forwards linear;
    }

    @keyframes HeaderExpand-Mobile{
        0%{height: 25px; opacity: 0;}
        100%{height: 385px; opacity: 1;}
    }
}

@media only screen and (min-device-width: 1400px) {
    /* Desktop and Tablet Styles */

    #Gallery-Container{
        align-self: center;
        padding: 10px;;
        width: 80%;
        display: flex;
        flex-wrap: wrap;
        position: relative;
        justify-content: center;
    }

    .img-desc{
        opacity: 0;
        animation: fadeout 0.15s forwards;
        font-size: 15px;
        margin: 5px;
        padding: 10px;
        padding-top: 5px;
        padding-bottom: 5px;
        border-left: #f9cecbe7 solid 2px;
        border-top: #f9cecbe7 solid 2px;
        border-right: #fffdb4de solid 2px;
        border-bottom: #fffdb4cb solid 2px;
        border-radius: 5px;
        background-color: #f1979094;
    }

    .desc-expanded{
        animation: fadein 0.6s forwards;
    }


    #page-body{
        display: grid;
        grid-column: 1;
        justify-content: center;
    }

    #title{
        align-self: center;
    }

    #FooterIcon{
        width: 10%;
    }

    #GalleryIntro{
        width: 55%;
        color: white;
        padding: 8px;
        background-color: #rgba(126, 95, 126, 0.705);;
        border-radius: 1px;
        height: 25px;
        z-index: 50;
        opacity: 0;
        animation: HeaderExpand .5s 1s forwards linear, RGBShadow-Large 6s linear alternate-reverse infinite;
        
    }

    h4{
        margin-top: 0px;
        margin-bottom: 0px;
    }

    #GalIntroContent{
        opacity: 0;
        font-size: larger;
        animation: fadein .5s 1.5s forwards linear;
        text-shadow: 4px black;
    }

    @keyframes HeaderExpand{
        0%{height: 25px; opacity: 0;}
        100%{height: 190px; opacity: 1;}
    }

    @keyframes expand {
        0%{height: 276px; transform: scale(1);}
        100%{height: 356px; transform: scale(1.6);}
    }
    @keyframes collapse {
        0%{height: 356px; transform: scale(1.6);}
        100%{height: 276px; transform: scale(1);}
    }
    @keyframes fadein {
        0%{opacity: 0;}
        100%{opacity: 1;}
    }
    @keyframes fadeout {
        0%{opacity: 1;}
        100%{opacity: 0;}
    }
    @keyframes zoomImg{
        0%{width: 256px; height:256px;}
        100%{width: 1000px; height:1000px;}
    }
}
    <% let maxScale = 0.2 %>
    <% let minScale = 0.15 %>
    <% items.forEach(item => { %>
    
    <% let aspectratio = item.imgWidth / item.imgHeight %>
    <% if(aspectratio != 1){ %>
    <% aspectratio = 1.1 + aspectratio %>
    <% } else { %>
    <% aspectratio = 1; %>
    <% } %>

    @media only screen and (max-device-width: 1400px) {
        /* Mobile Styles */
        .<%= 'item'+item.id+'-item'%>{
            width:<%= item.imgWidth * 0.15 %>px;
            height: <%= (item.imgHeight * 0.15)+100 %>px;
            margin: 5px;
            animation: <%= 'item'+item.id+'-collapse'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-img'%>{
            animation: <%= 'item'+item.id+'-imgCollapse'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-imgExpanded'%>{
            animation: <%= 'item'+item.id+'-imgExpand'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-expanded'%>{
            animation: <%= 'item'+item.id+'-expand'%> 0.3s forwards;
            z-index: 10;
        }

        @keyframes <%= 'item'+item.id+'-expand'%>{
            0%{width:<%= item.imgWidth * minScale+100 %>px; height: <%= (item.imgHeight * minScale+100)+40 %>px; transform: scale(1);}
            100%{width:<%= item.imgWidth * maxScale+100 %>px; height: <%= (item.imgHeight * maxScale+100)+155 %>px; transform: scale(1.7);}
            
        }

        @keyframes <%= 'item'+item.id+'-collapse'%>{
            0%{width:<%= item.imgWidth * maxScale+100 %>px; height: <%= (item.imgHeight * maxScale+100)+155 %>px; transform: scale(1.7);}
            100%{width:<%= item.imgWidth * minScale+100 %>px; height: <%= (item.imgHeight * minScale+100)+40*aspectratio %>px; transform: scale(1);}
        }

        @keyframes <%= 'item'+item.id+'-imgCollapse'%>{
            0%{width:<%= item.imgWidth * maxScale+100 %>px;}
            100%{width:<%= item.imgWidth * minScale+100 %>px;}
        }

        @keyframes <%= 'item'+item.id+'-imgExpand'%>{
            0%{width:<%= item.imgWidth * minScale+100 %>px;}
            100%{width:<%= item.imgWidth * maxScale+100 %>px;}
        }
    }


    @media only screen and (min-device-width: 1400px) {
        /* Desktop Styles */
        .<%= 'item'+item.id+'-item'%>{
            width:<%= item.imgWidth * 0.15 %>px;
            height: <%= (item.imgHeight * 0.15)+100 %>px;
            margin: 5px;
            animation: <%= 'item'+item.id+'-collapse'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-img'%>{
            animation: <%= 'item'+item.id+'-imgCollapse'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-imgExpanded'%>{
            animation: <%= 'item'+item.id+'-imgExpand'%> 0.3s forwards;
        }

        .<%= 'item'+item.id+'-expanded'%>{
            animation: <%= 'item'+item.id+'-expand'%> 0.3s forwards;
            z-index: 10;
        }

        @keyframes <%= 'item'+item.id+'-expand'%>{
            0%{width:<%= item.imgWidth * minScale %>px; height: <%= (item.imgHeight * minScale)+20 %>px; transform: scale(1);}
            100%{width:<%= item.imgWidth * maxScale %>px; height: <%= (item.imgHeight * maxScale)+120 %>px; transform: scale(1.2);}
            
        }

        @keyframes <%= 'item'+item.id+'-collapse'%>{
            0%{width:<%= item.imgWidth * maxScale %>px; height: <%= (item.imgHeight * maxScale)+120 %>px; transform: scale(1.2);}
            100%{width:<%= item.imgWidth * minScale %>px; height: <%= (item.imgHeight * minScale)+20 %>px; transform: scale(1);}
        }

        @keyframes <%= 'item'+item.id+'-imgCollapse'%>{
            0%{width:<%= item.imgWidth * maxScale %>px;}
            100%{width:<%= item.imgWidth * minScale %>px;}
        }

        @keyframes <%= 'item'+item.id+'-imgExpand'%>{
            0%{width:<%= item.imgWidth * minScale %>px;}
            100%{width:<%= item.imgWidth * maxScale %>px;}
        }
    }
    <%}); %>

</style>

<div class="CenterBody">
    <h1 id="title" class="RainbowText GlitchHeader"> The Gallery </h1>
</div>

<div class="CenterBody">
    <div id="Galleryintro">
        <h4>Important Information About the Gallery</h4>
        <div id="GalIntroContent">
            <p>Right now, the gallery is curated for our application to vend at FurEh this year. Below are some of the products and items we'd like to bring. Click on each item to see a description along with a higher-resolution image.</p>
            <p>There are more things we'd like to make and bring, but unfortunately, I won't have time to create samples of them before this page is reviewed. So, if you're interested, keep checking back!</p>
            <p>Additionally, this gallery application is somewhat experimental, as I made it myself. It should work on mobile and desktop, but I haven't had the chance to test it extensively.</p>
        </div>
    </div>
</div>

<div class="CenterBody">
    <div id="Gallery-Container">
        <% items.forEach(item => { %>
            <div class="<%= 'item'+item.id+'-item'%> window" id="item<%=item.id%>">
                <div class="title-bar">
                    <div class="title-bar-text">
                        <%= item.imgTitle %>
                    </div>
            
                    <div class="title-bar-controls">
                        <button aria-label="Minimize" onclick="CollapseItem(<%='item' + item.id%>,'<%=item.imgPath%>')"></button>
                        <button aria-label="Maximize" onclick="ExpandItem(<%='item' + item.id%>,'<%=item.imgPath%>')"></button>
                        <button aria-label="Close" onclick="CollapseItem(<%='item' + item.id%>,'<%=item.imgPath%>')"></button>
                    </div>
                    
                </div>
                <div class="gallery-window-body">
                    <img class="<%= 'item'+item.id+'-img'%>" src="<%= '/gallery/thumb/' + item.imgPath + '_S.png'%>" id="item<%=item.id%>-img" onclick="ToggleExpand(<%='item' + item.id%>, '<%=item.imgPath%>')"/>
                    <div>
                        <div class="img-desc window-body" id="item<%=item.id%>-desc"><%= item.imgDescription %></div>
                    </div>
                </div>

            </div>
        <%}); %>
    </div>
</div>

<%- include('partials/footer'); -%>

